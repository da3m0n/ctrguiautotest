<html>
<head>
    <title>Smoke Tests</title>
    <link rel="stylesheet" href="../css/smoketests.css"/>

    <script>
        var loadLogs = (function () {

            function loadXMLDoc(filename) {
                var xhttp;

                if (window.ActiveXObject) {
                    xhttp = new ActiveXObject("Msxml2.XMLHTTP");
                }
                else {
                    xhttp = new XMLHttpRequest();
                }
                xhttp.open("GET", filename, false);
                try {
                    xhttp.responseType = "msxml-document"
                } catch (err) {
                } // Helping IE11
                xhttp.send("");
//                return xhttp.responseXML;

                return {
                    response: xhttp.responseXML,
                    responseType: xhttp.responseType
                }
            }


            function displayResult() {
                var xml = loadXMLDoc("testLog.xml");
                var xsl = loadXMLDoc("testLog.xsl");
                // code for IE
                if (window.ActiveXObject || xml.responseType === "msxml-document") {
                    var ex = xml.response.transformNode(xsl.response);
                    document.getElementById("resultsContainer").innerHTML = ex;
                }
                // code for Chrome, Firefox, Opera, etc.
                else if (document.implementation && document.implementation.createDocument) {
                    var xsltProcessor = new XSLTProcessor();
                    xsltProcessor.importStylesheet(xsl.response);
                    var resultDocument = xsltProcessor.transformToFragment(xml.response, document);
                    document.getElementById("resultsContainer").appendChild(resultDocument);
                }

            }

            return {
                init: function () {
                    displayResult();
                }
            };
        })();

    </script>
</head>
<body>
<div id="resultsContainer"></div>
<script>
    window.onload = loadLogs.init();
</script>
</body>
</html>